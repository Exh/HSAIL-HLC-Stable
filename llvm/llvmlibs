LLVM_LIB = $(LLVM_DEPTH)/lib

# This could really be done by calling uniq = $(if $1,$(call uniq,$(call chop,$1)...))
# but make 3.79.1 does not like recursive variables...
uniq = $(shell $(OPENCL_DEPTH)/tools/uniq/$(if \
	$(ATI_OS_WINDOWS),windows,linux)/uniq $1)

LLVMSupportLIB = $(LLVM_LIB)/Support/$(FULL_BUILD_DIR)/LLVMSupport$(LIB_EXT)
LLVMSupportDEPS =
LLVMSupportLIBS = $(LLVMSupportLIB) $(LLVMSupportDEPS)

LLVMCoreLIB = $(LLVM_LIB)/VMCore/$(FULL_BUILD_DIR)/LLVMVMCore$(LIB_EXT)
LLVMCoreDEPS = \
	$(LLVMSupportLIBS)
LLVMCoreLIBS = $(LLVMCoreLIB) $(LLVMCoreDEPS)

LLVMBitReaderLIB = $(LLVM_LIB)/Bitcode/Reader/$(FULL_BUILD_DIR)/LLVMBitReader$(LIB_EXT)
LLVMBitReaderDEPS = \
	$(LLVMCoreLIBS)
LLVMBitReaderLIBS = $(LLVMBitReaderLIB) $(LLVMBitReaderDEPS)

LLVMBitWriterLIB = $(LLVM_LIB)/Bitcode/Writer/$(FULL_BUILD_DIR)/LLVMBitWriter$(LIB_EXT)
LLVMBitWriterDEPS = \
	$(LLVMCoreLIBS)
LLVMBitWriterLIBS = $(LLVMBitWriterLIB) $(LLVMBitWriterDEPS)

LLVMAsmParserLIB = $(LLVM_LIB)/AsmParser/$(FULL_BUILD_DIR)/LLVMAsmParser$(LIB_EXT)
LLVMAsmParserDEPS = \
	$(LLVMCoreLIBS)
LLVMAsmParserLIBS = $(LLVMAsmParserLIB) $(LLVMAsmParserDEPS)

LLVMArchiveLIB = $(LLVM_LIB)/Archive/$(FULL_BUILD_DIR)/LLVMArchive$(LIB_EXT)
LLVMArchiveDEPS = \
	$(LLVMBitReaderLIBS)
LLVMArchiveLIBS = $(LLVMArchiveLIB) $(LLVMArchiveDEPS)

LLVMLinkerLIB = $(LLVM_LIB)/Linker/$(FULL_BUILD_DIR)/LLVMLinker$(LIB_EXT)
LLVMLinkerDEPS = \
	$(LLVMArchiveLIBS) $(LLVMTransformUtilsLIBS)
LLVMLinkerLIBS = $(LLVMLinkerLIB) $(LLVMLinkerDEPS)

LLVMMCLIB = $(LLVM_LIB)/MC/$(FULL_BUILD_DIR)/LLVMMC$(LIB_EXT)
LLVMMCDEPS = \
	$(LLVMSupport)
LLVMMCLIBS = $(LLVMMCLIB) $(LLVMMCDEPS)

LLVMTargetLIB = $(LLVM_LIB)/Target/$(FULL_BUILD_DIR)/LLVMTarget$(LIB_EXT)
LLVMTargetDEPS = \
	$(LLVMMCLIBS) \
	$(LLVMCoreLIBS)
LLVMTargetLIBS = $(LLVMTargetLIB) $(LLVMTargetDEPS)

LLVMAnalysisLIB = $(LLVM_LIB)/Analysis/$(FULL_BUILD_DIR)/LLVMAnalysis$(LIB_EXT)
LLVMAnalysisDEPS = \
	$(LLVMTargetLIBS)
LLVMAnalysisLIBS = $(LLVMAnalysisLIB) $(LLVMAnalysisDEPS)

LLVMMCParserLIB = $(LLVM_LIB)/MC/MCParser/$(FULL_BUILD_DIR)/LLVMMCParser$(LIB_EXT)
LLVMMCParserDEPS = \
	$(LLVMMCLIBS)
LLVMMCParserLIBS = $(LLVMMCParserLIB) $(LLVMMCParserDEPS)

LLVMScalarOptsLIB = $(LLVM_LIB)/Transforms/Scalar/$(FULL_BUILD_DIR)/LLVMScalarOpts$(LIB_EXT)
LLVMScalarOptsDEPS = \
	$(LLVMVectorizeLIBS) $(LLVMSPIRLIB)
LLVMScalarOptsLIBS = $(LLVMScalarOptsLIB) $(LLVMScalarOptsDEPS)

LLVMCodeGenLIB = $(LLVM_LIB)/CodeGen/$(FULL_BUILD_DIR)/LLVMCodeGen$(LIB_EXT)
LLVMCodeGenDEPS = \
	$(LLVMScalarOptsLIBS)
LLVMCodeGenLIBS = $(LLVMCodeGenLIB) $(LLVMCodeGenDEPS)

LLVMVectorizeLIB = $(LLVM_LIB)/Transforms/Vectorize/$(FULL_BUILD_DIR)/LLVMVectorize$(LIB_EXT)
LLVMVectorizeDEPS = \
	$(LLVMInstCombineLIBS)
LLVMVectorizeLIBS = $(LLVMVectorizeLIB) $(LLVMVectorizeDEPS)

LLVMInstCombineLIB = $(LLVM_LIB)/Transforms/InstCombine/$(FULL_BUILD_DIR)/LLVMInstCombine$(LIB_EXT)
LLVMInstCombineDEPS = \
	$(LLVMTransformUtilsLIBS)
LLVMInstCombineLIBS = $(LLVMInstCombineLIB) $(LLVMInstCombineDEPS)

LLVMTransformUtilsLIB = $(LLVM_LIB)/Transforms/Utils/$(FULL_BUILD_DIR)/LLVMTransformUtils$(LIB_EXT)
LLVMTransformUtilsDEPS = \
	$(LLVMipaLIBS)
LLVMTransformUtilsLIBS = $(LLVMTransformUtilsLIB) $(LLVMTransformUtilsDEPS)

LLVMInstrumentationLIB = $(LLVM_LIB)/Transforms/Instrumentation/$(FULL_BUILD_DIR)/LLVMInstrumentation$(LIB_EXT)
LLVMInstrumentationDEPS = \
	$(LLVMAnalysisLIBS) \
	$(LLVMTransformUtilsLIBS)
LLVMInstrumentationLIBS = $(LLVMInstrumentationLIB) $(LLVMInstrumentationDEPS)

LLVMipoLIB = $(LLVM_LIB)/Transforms/IPO/$(FULL_BUILD_DIR)/LLVMipo$(LIB_EXT)
LLVMipoDEPS = \
	$(LLVMScalarOptsLIBS)
LLVMipoLIBS = $(LLVMipoLIB) $(LLVMipoDEPS)

LLVMSPIRLIB = $(LLVM_LIB)/Transforms/SPIR/$(FULL_BUILD_DIR)/LLVMSPIR$(LIB_EXT)
LLVMSPIRDEPS = \
	$(LLVMScalarOptsLIBS)
LLVMSPIRLIBS = $(LLVMSPIRLIB) $(LLVMSPIRDEPS)

LLVMipaLIB = $(LLVM_LIB)/Analysis/IPA/$(FULL_BUILD_DIR)/LLVMipa$(LIB_EXT)
LLVMipaDEPS = \
	$(LLVMAnalysisLIBS)
LLVMipaLIBS = $(LLVMipaLIB) $(LLVMipaDEPS)

LLVMSelectionDAGLIB = $(LLVM_LIB)/CodeGen/SelectionDAG/$(FULL_BUILD_DIR)/LLVMSelectionDAG$(LIB_EXT)
LLVMSelectionDAGDEPS = \
	$(LLVMCodeGenLIBS)
LLVMSelectionDAGLIBS = $(LLVMSelectionDAGLIB) $(LLVMSelectionDAGDEPS)

LLVMAsmPrinterLIB = $(LLVM_LIB)/CodeGen/AsmPrinter/$(FULL_BUILD_DIR)/LLVMAsmPrinter$(LIB_EXT)
LLVMAsmPrinterDEPS = \
	$(LLVMCodeGenLIBS) \
	$(LLVMMCParserLIBS)
LLVMAsmPrinterLIBS = $(LLVMAsmPrinterLIB) $(LLVMAsmPrinterDEPS)

ifneq ($(BUILD_CPU_DEVICE),no)
ifdef ATI_ARCH_ARM
LLVMARMCodeGenLIB = $(LLVM_LIB)/Target/ARM/$(FULL_BUILD_DIR)/LLVMARMCodeGen$(LIB_EXT)
LLVMARMCodeGenDEPS = \
	$(LLVMAsmPrinterLIBS) \
	$(LLVMSelectionDAGLIBS)
LLVMARMCodeGenLIBS = $(LLVMARMCodeGenLIB) $(LLVMARMCodeGenDEPS)
endif

ifdef ATI_ARCH_X86
LLVMX86CodeGenLIB = $(LLVM_LIB)/Target/X86/$(FULL_BUILD_DIR)/LLVMX86CodeGen$(LIB_EXT)
LLVMX86CodeGenDEPS = \
	$(LLVMAsmPrinterLIBS) \
	$(LLVMSelectionDAGLIBS)
LLVMX86CodeGenLIBS = $(LLVMX86CodeGenLIB) $(LLVMX86CodeGenDEPS)
endif
endif

ifneq ($(BUILD_GPU_DEVICE),no)
LLVMAMDILCodeGenLIB = $(LLVM_LIB)/Target/AMDIL/$(FULL_BUILD_DIR)/LLVMAMDILCodeGen$(LIB_EXT)
LLVMAMDILCodeGenDEPS = \
	$(LLVMMacroDataLIBS) \
	$(LLVMAsmPrinterLIBS) \
	$(LLVMSelectionDAGLIBS)
LLVMAMDILCodeGenLIBS = $(LLVMAMDILCodeGenLIB) $(LLVMAMDILCodeGenDEPS)
endif

LIBHSAILLIBS = $(OPENCL_DEPTH)/compiler/hsail-tools/libHSAIL/$(FULL_BUILD_DIR)/LIBHSAIL$(LIB_EXT)
LLVMHSAILCodeGenLIB = $(LLVM_LIB)/Target/HSAIL/$(FULL_BUILD_DIR)/LLVMHSAILCodeGen$(LIB_EXT)
LLVMHSAILCodeGenDEPS = \
        $(LIBHSAILLIBS) \
	$(LLVMObjectLIBS) \
	$(LLVMAsmPrinterLIBS) \
	$(LLVMSelectionDAGLIBS)
LLVMHSAILCodeGenLIBS = $(LLVMHSAILCodeGenLIB) $(LLVMHSAILCodeGenDEPS)

LLVMMacroDataLIB = $(OPENCL_DEPTH)/compiler/tools/macrodata/$(FULL_BUILD_DIR)/LLVMMacroData$(LIB_EXT)
LLVMMacroDataDEPS = # nothing
LLVMMacroDataLIBS = $(LLVMMacroDataLIB) $(LLVMMacroDataDEPS)

LLVMRuntimeDyldLIB = $(LLVM_LIB)/ExecutionEngine/RuntimeDyld/$(FULL_BUILD_DIR)/LLVMRuntimeDyld$(LIB_EXT)
LLVMRuntimeDyldDEPS = \
	 $(LLVMObjectLIBS)
LLVMRuntimeDyldLIBS = $(LLVMRuntimeDyldLIB) $(LLVMRuntimeDyldDEPS)

LLVMMCJITLIB = $(LLVM_LIB)/ExecutionEngine/MCJIT/$(FULL_BUILD_DIR)/LLVMMCJIT$(LIB_EXT)
LLVMMCJITDEPS = \
	 $(LLVMCodeGenLIBS) $(LLVMTargetLIBS) $(LLVMRuntimeDyldLIBS)
LLVMMCJITLIBS = $(LLVMMCJITLIB) $(LLVMMCJITDEPS)


LLVMJITLIB = $(LLVM_LIB)/ExecutionEngine/JIT/$(FULL_BUILD_DIR)/LLVMJIT$(LIB_EXT)
LLVMJITDEPS = \
  $(LLVMCodeGenLIBS) $(LLVMTargetLIBS)
LLVMJITLIBS = $(LLVMJITLIB) $(LLVMJITDEPS)


LLVMInterpreterLIB = $(LLVM_LIB)/ExecutionEngine/Interpreter/$(FULL_BUILD_DIR)/LLVMInterpreter$(LIB_EXT)
LLVMInterpreterDEPS = \
	 $(LLVMCodeGenLIBS) $(LLVMTargetLIBS)
LLVMInterpreterLIBS = $(LLVMInterpreterLIB) $(LLVMInterpreterDEPS)


LLVMExecutionEngineLIB = $(LLVM_LIB)/ExecutionEngine/$(FULL_BUILD_DIR)/LLVMExecutionEngine$(LIB_EXT)
LLVMExecutionEngineDEPS = \
	 $(LLVMTargetLIBS)  $(LLVMCodeGenLIBS) $(LLVMInterpreterLIBS)
LLVMExecutionEngineLIBS = $(LLVMExecutionEngineLIB) $(LLVMExecutionEngineDEPS)


LLVMTableGenLIB = $(LLVM_LIB)/TableGen/$(FULL_BUILD_DIR)/LLVMTableGen$(LIB_EXT)
LLVMTableGenDEPS =
LLVMTableGenLIBS = $(LLVMTableGenLIB) $(LLVMTableGenDEPS)


LLVMObjectLIB = $(LLVM_LIB)/Object/$(FULL_BUILD_DIR)/LLVMObject$(LIB_EXT)
LLVMObjectDEPS = $(LLVMSupportLIBS)
LLVMObjectLIBS = $(LLVMObjectLIB) $(LLVMObjectDEPS)


LLVMDebugInfoLIB = $(LLVM_LIB)/DebugInfo/$(FULL_BUILD_DIR)/LLVMDebugInfo$(LIB_EXT)
LLVMDebugInfoDEPS =
LLVMDebugInfoLIBS = $(LLVMDebugInfoLIB) $(LLVMDebugInfoDEPS)

LLVMOpenCLIRLIB = $(LLVM_LIB)/Transforms/OpenCLIR/$(FULL_BUILD_DIR)/LLVMOpenCLIR$(LIB_EXT)
LLVMOpenCLIRDEPS = \
  	$(LLVMScalarOptsLIBS) $(LLVMSPIRLIB)
LLVMOpenCLIRLIBS = $(LLVMOpenCLIRLIB) $(LLVMOpenCLIRDEPS)
